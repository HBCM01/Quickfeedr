<div class="container">
  <h1>All Jobs</h1>

  <div class="search">

    <div class="search-form">
      <%= form_tag jobs_path, method: :get, class: "rel", id: "form" do %>
        <input type="text" name="query" class="form-control rel" placeholder="Search all jobs..." >
        <i class="fa fa-search tb"></i>
      <% end %>
    </div>

    <br>
  </div>




  <br>
  <div class="job-container">
    <div class="job-all col-7" data-turbolinks-permanent>
      <% @jobs.each do |job| %>
        <div class="job-card">
          <%= link_to job_path(job, query: params[:query]), class: 'job-link' do %>

            <div class="job-title">
              <% if job.photo.attached? %>
                <%= cl_image_tag job.photo.key, height: 50, width: 50, crop: :fill, class: "card-image" %>
              <% end %>
              <div>
              <h3><%= job.title %></h3>
              <h4><%= job.location %></h4>
              <h5><%= job.salary %></h5>
              </div>
            </div>

            <div class="job-container">
                <h5><%= job.description %></h5>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>

    <div class=" col-5 " id="job-map">
      <div class="job-location">
        <h3><%= @job.title %></h3>
        <h4><%= @job.location %></h4>
        <h5><%= @job.salary %></h5>
        <p><%= @job.description %></p>
        <p><%= @job.job_spec %></p>
        <button><%= link_to "Apply Now!", job_job_applications_path(@job, anchor: "job-#{@job.id}"), method: :post  %></button>
      </div>

       <div id="map"
      style="width: 100%; height: 300px;"
      data-markers="<%= @markers.to_json %>"
      data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>

    </div>
  </div>

</div>

<script>
  document.querySelector(".tb").addEventListener("click", () => {
    document.getElementById("form").submit();
  })
</script>
